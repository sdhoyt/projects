{
  "hash": "a9249a3872a904aef4aaaf0337496c47",
  "result": {
    "markdown": "---\ntitle: 'Alternative Fuel Stations'\ndescription: Tidy Tuesday R analysis on alternative fuel station locations with data visualization and linear regression model inference.\nauthor: \"Sean Hoyt\"\ndate: '2022-05-20'\ncategories: [R, tidy-tuesday, analysis, data-viz, eda, animation, regression, inference]\nformat:\n  html:\n    toc: true\n---\n\n\n[Link to Github repository](https://github.com/sdhoyt/alt-fuel-station-analysis/blob/main/alt-fuel-station.qmd)\n\n\n\n\n\n# Introduction\n\nThe dataset used for this analysis contains information on [alternative fuel stations](https://github.com/rfordatascience/tidytuesday/blob/master/data/2022/2022-03-01/readme.md) from the [R for Data Science's Tidy Tuesday Github page](https://github.com/rfordatascience/tidytuesday). The original source of the data is the [US Department of Energy](https://afdc.energy.gov/data_download/alt_fuel_stations_format). The goal for this analysis is to better understand which alternative fuel stations are most prominent, how they're distributed accross the US, and what relationships exist between state populations and the number of stations in each state.\n\n### Alternative Fuel Station Data\n\nThe main features from the [alternative fuel stations data](https://afdc.energy.gov/data_download/alt_fuel_stations_format) that this analysis will focus on are the following:\n\n+-----------+------------------------------------------------------------------------------------------------------------+\n| Name      | Description                                                                                                |\n+===========+============================================================================================================+\n| State     | The two character code for the U.S. state or Canadian province/territory of the station's location         |\n+-----------+------------------------------------------------------------------------------------------------------------+\n| City      | The city of the station's location                                                                         |\n+-----------+------------------------------------------------------------------------------------------------------------+\n| Latitude  | The latitude of the station's address                                                                      |\n+-----------+------------------------------------------------------------------------------------------------------------+\n| Longitude | The longitude of the station's address                                                                     |\n+-----------+------------------------------------------------------------------------------------------------------------+\n| Fuel Type | The type of alternative fuel the station provides. Fuel types are given as code values as described below: |\n|           |                                                                                                            |\n|           | | Value | Description                  |                                                                   |\n|           | |-------|------------------------------|                                                                   |\n|           | | BD    | Biodiesel (B20 and above)    |                                                                   |\n|           | | CNG   | Compressed Natural Gas (CNG) |                                                                   |\n|           | | ELEC  | Electric                     |                                                                   |\n|           | | E85   | Ethanol (E85)                |                                                                   |\n|           | | HY    | Hydrogen                     |                                                                   |\n|           | | LNG   | Liquefied Natural Gas (LNG)  |                                                                   |\n|           | | LPG   | Propane (LPG)                |                                                                   |\n+-----------+------------------------------------------------------------------------------------------------------------+\n\n### Population Data\n\nThere are two sets of population data we'll use in order to construct a full 2010 - 2020 dataset. The first population dataset contains the years 2010 - 2019 and the second contains 1910 - 2020, but only for every 10 years. We will combine the two datasets to get yearly state populations for all years between 2010 to 2020.\n\nThe main features from the [2010 to 2019 Census data](https://www.census.gov/data/datasets/time-series/demo/popest/2010s-state-total.html) that this analysis will focus on are th following:\n\n+--------------------------+--------------------------------------------------------------------------------------+\n| Name                     | Description                                                                          |\n+==========================+======================================================================================+\n| Name                     | Name of the area containing the population (Nation, State, Region)                   |\n+--------------------------+--------------------------------------------------------------------------------------+\n| Population               | Resident population estimates                                                        |\n+--------------------------+--------------------------------------------------------------------------------------+\n| POPESTIMATE\\[2010-2019\\] | Multiple columns containing the population for the year specified in the column name |\n+--------------------------+--------------------------------------------------------------------------------------+\n\nThe main features from the [1910 - 2020 Census data](https://www.census.gov/data/tables/time-series/dec/density-data-text.html) that this analysis will focus on are the following:\n\n+---------------+--------------------------------------------------------------------+\n| Name          | Description                                                        |\n+===============+====================================================================+\n| Name          | Name of the area containing the population (Nation, State, Region) |\n+---------------+--------------------------------------------------------------------+\n| Population    | Resident population estimates                                      |\n+---------------+--------------------------------------------------------------------+\n\n# Data Wrangling\n\n### Load Libraries\n\nFor this analysis we'll make use of the `tidytuesdayR` package to load the Tidy Tuesday dataset; the `tidyverse` ecosystem for data tidying, manipulation, exploration, and visualization; `ggpubr` for displaying correlations on plots; `lubridate` for handling datetimes; `tidymodels` for building a regression model; `kntr` for creating tables; and `gganimate` for animating visualizations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidytuesdayR)\nlibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(lubridate)\nlibrary(tidymodels)\nlibrary(knitr)\nlibrary(gganimate)\ntheme_set(theme_light())\n```\n:::\n\n\n### Import Data\n\nThe 03/01/2022 Tidy Tuesday data is loaded in using the `tidytuesdayR` package, along with the Census data. We can also create a state reference dataframe to help with merging tables where one has the state abbreviation and the other has the state's full name. The state area can also be added to later calculate station densities.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntuesdata <- tidytuesdayR::tt_load('2022-03-01')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 1: `stations.csv`\n```\n:::\n\n```{.r .cell-code}\nstations_raw <- tuesdata$stations\n\n# https://www.census.gov/data/datasets/time-series/demo/popest/2010s-state-total.html\n# Census data 2010 - 2019\npop_raw <- read_csv(\"https://www2.census.gov/programs-surveys/popest/datasets/2010-2019/national/totals/nst-est2019-alldata.csv\")\n#https://www.census.gov/data/tables/time-series/dec/density-data-text.html\n# census data 1910 - 2020 (every 10 years)\npop_raw_2020 <- read_csv(\"https://www2.census.gov/programs-surveys/decennial/2020/data/apportionment/apportionment.csv\")\n\n# create state abbrevation/name ref table\nstates_ref <- tibble(\n    name = state.name,\n    abbr = state.abb,\n    area = state.area\n)\n```\n:::\n\n\n## Clean Data\n\nOur main set of Census data is cleaned by removing any observations that aren't states, reshaping the dataframe so each year is in a single column, joining with the `state_ref` dataframe to get the state land area and finally calculating the population densities. The other set of Census data we'll use to get values for 2020 is filtered and joined to our main Census data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n pop_density_2020 <- pop_raw_2020 |> \n    # only look at the year 2020 and state data\n    filter(Year == 2020, `Geography Type` == \"State\") |> \n    # rename and select relevant columns\n    transmute(\n      state = Name, \n      year = as.character(Year), \n      pop_den = `Resident Population Density`, \n      pop=`Resident Population`) |> \n    # join with the states_ref data to get the state abbreviations\n    inner_join(states_ref, by=c(\"state\" = \"name\")) |> \n    select(state, year, pop)\n\npop_density <- pop_raw |> \n  # remove non state observation\n  filter(STATE != \"00\") |> \n  # gather the pop estimate column headers into a single column for \n  # year and the values into a new pop column\n  pivot_longer(\n    cols = starts_with(\"POPESTIMATE\"),\n    names_to = \"year\", \n    values_to = \"pop\") |> \n  # downselect the columns\n  transmute(state = NAME, year, pop) |> \n  # separate the year from the POPESTIMATE text \n  separate(col=year, sep = \"POPESTIMATE\", into=c(NA, \"year\")) |> \n  # add 2020 data\n  bind_rows(pop_density_2020) |> \n  # join with the state area data\n  inner_join(states_ref, by=c(\"state\" = \"name\")) |> \n  # calcualte the population density\n  mutate(pop_den = pop / area, year = as.numeric(year)) |> \n  # select the columns of interest\n  select(state, abbr, year, pop_den, area)\n```\n:::\n\n\nThe `stations_raw` data is cleaned by changing the categorical data to factors, changing the `OPEN_DATE` variable from a string to a date, and creating a new `open_year` variable that contains only the year that the station was opened. The latitude/longitudes are also filtered to restrict the data to only that found in the US. The data is then joined with the census data.\n\nSince much of this analysis refers to population data and we do not have population densities after the year 2020 available, we will drop any station data with the inner join for years where we do not have population density data (before 2010, after 2020).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations <- stations_raw |> \n    # rename columns, convert to factors and dates\n    transmute(\n      state = factor(STATE), \n      city = factor(CITY), \n      lat = LATITUDE, \n      lon = LONGITUDE, \n      fuel_type = factor(FUEL_TYPE_CODE),\n      open_date = ymd_hms(OPEN_DATE),\n      open_year = as.numeric(year(OPEN_DATE))\n      ) |> \n    # filter by lat/lon for continental US\n    filter(lat > 24 & lat < 52, lon < -64 & lon > -126) |> \n    # join with the population data\n    inner_join(pop_density, by=c(\"state\" = \"abbr\", \"open_year\" = \"year\")) |> \n    # rename the state columns\n    rename(abbr = state, state = state.y) |> \n    # move the state column to the front\n    relocate(state, .before = everything())\n```\n:::\n\n\n# Exploratory Data Analysis\n\n### Fuel Stations Distribution Across the US\n\nWe can create a histogram of stations by their latitude to get a one dimensional view of how they are distributed from south to north. The histograms can be separated based on fuel type to see how the distributions for each vary. Note that the y-axis varies by histogram, so the bar heights themselves are not comparable between plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations |> \n    ggplot(aes(lat)) +\n    geom_histogram(bins=15) + \n    facet_wrap(vars(fuel_type), scales=\"free_y\") + \n    labs(\n      x=\"Latitude\", \n      y=\"Electric Stations\", \n      title=\"Distribution of Electric Stations by Latitude\"\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nWe can see from the histograms that Electric, Hydrogen, Liquified Natural Gas, and Propane are mostly used in the middle latitudes. This may be a result of a large number of cities such as Baltimore, Washington D.C. Philadelphia, Denver, and San Franscio being located in the central latitudes.\n\nEthanol's distribution is left skewed, showing that more stations are used in the northern latitudes than the southern latitudes.\n\nWe can do the same for longitudes to better understand the distribution of fuel stations from west to east.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations |> \n    ggplot(aes(lon)) +\n    geom_histogram(bins=15) + \n    facet_wrap(vars(fuel_type), scales=\"free_y\") + \n    labs(\n      x=\"Longitude\", \n      y=\"Stations\", \n      title=\"Distribution of Stations by Longitude\"\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nLooking at the longitude distributions, we can see that more electric fuel stations are located in the west and east coasts than in the middle of the country. Ethanol and Propane however are more prominent in the middle of the country than closer to the coasts.\n\nTo better visualize the overall distribution, we can create a new map showing the locations of each fuel station. To reduce clutter, we can plot each fuel type separately and color by state.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations |> \n    ggplot(aes(lon, lat, color=state)) +\n    borders(\"state\") + \n    geom_point(size=0.1, alpha=.4, show.legend = FALSE) +\n    coord_map() +\n    theme_void() +\n    facet_wrap(vars(fuel_type)) + \n    labs(title=\"Locations of Each Station Fuel Type\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nFrom looking at the maps, electric fuel stations seem to vastly outnumber all other fuel stations, with Hydrogen looking to be the least utilized. Biodiesel looks to be very prominent in North Carolina and South Carolina, filling most of the states, as well as the southern part of Minnesota. Ethanol looks to be most prominently used in the Great Lakes and part of the Mid-West.\n\nBecause electric fuel stations are the most prominent type, we can take a more detailed look at that map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations |> \n    filter(fuel_type == \"ELEC\") |> \n    ggplot(aes(lon, lat, color=state)) +\n    borders(\"state\") + \n    geom_point(size=.1, alpha=.2, show.legend = FALSE) +\n    coord_map() +\n    theme_void() + \n    labs(title=\"Locations for all Electric Stations\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nAdding animation to the map allows us to view how the distributions of electric fueling stations changed as more were added over time. It appears from the animation that there was a steady rise in electric stations starting in the years 2011-2012 which is likely due to the fact that the first mass produced electric vehicles, the Nissan Leaf and Chevy Volt, were released in December 2010.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations |> \n    filter(fuel_type == \"ELEC\", !is.na(open_year)) |> \n    ggplot(aes(lon, lat, color=state)) +\n    borders(\"state\") + \n    geom_point(aes(group = seq_along(open_year)), size=.1, show.legend = FALSE) +\n    coord_map() +\n    theme_void() + \n    labs(title=\"Electric Fueling Stations\", \n         subtitle=\"Year: {round(frame_along)}\") + \n    transition_reveal(open_year)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.gif)\n:::\n:::\n\n\nPlotting the cumulative sum of station openings over time, we can see the steady increase in stations over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Popular electric vehicle release dates\nleaf_volt <- as.POSIXct(\"2010-12-15\")\nmodel_s <- as.POSIXct(\"2012-06-22\")\nmodel_3 <- as.POSIXct(\"2017-07-07\")\n\n# calculate electric station cumulation over time\ncuml_stations <- stations %>%\n    # only look at electric\n    filter(fuel_type == \"ELEC\") |> \n    # count the openings for each date\n    count(open_date, name=\"total\") |> \n    # arrange by open date to prepare for a cumulative sum\n    arrange(open_date) |> \n    # get the cumulative sum of the openings across each date\n    mutate(sum = cumsum(total))\n\n# plot the cumulative openings\ncuml_stations |> \n    ggplot(aes(open_date, sum)) +\n    geom_line(show.legend = FALSE) + \n    scale_x_datetime(date_break = \"year\", date_labels = \"%Y\") + \n    labs(\n      x = \"Station Opening Date\", \n      y = \"Total Electric Stations\", \n      title=\"Total Electric Stations over Time\"\n      ) +\n    geom_vline(\n      xintercept = leaf_volt, \n      linetype=\"longdash\", \n      color=\"darkred\"\n      ) +\n    annotate(\n      \"text\", \n      x=as.POSIXct(\"2010-06-01\"), \n      y=25000, \n      label=str_wrap(\"Nissan Leaf and Chevy Volt released\", width=10), \n      size=2,\n      color=\"darkred\"\n      ) +\n    geom_vline(\n      xintercept = model_s, \n      linetype=\"longdash\", \n      color=\"darkred\"\n      ) + \n    annotate(\n      \"text\", \n      x=as.POSIXct(\"2012-01-01\"), \n      y=25000, \n      label=str_wrap(\"Telsa Model S released\", width=10), \n      size=2,\n      color=\"darkred\"\n      ) +\n    geom_vline(\n      xintercept = model_3, \n      linetype=\"longdash\", \n      color=\"darkred\"\n      ) + \n    geom_vline(\n      xintercept = model_3, \n      linetype=\"longdash\", \n      color=\"darkred\"\n      ) + \n    annotate(\n      \"text\", \n      x=as.POSIXct(\"2017-01-01\"), \n      y=25000, \n      label=str_wrap(\"Telsa Model 3 released\", width=10), \n      size=2,\n      color=\"darkred\"\n      ) +\n    annotate(\n      \"segment\", \n      x= as.POSIXct(\"2011-02-01\"), \n      xend=as.POSIXct(\"2012-02-01\"), \n      y=3000, \n      yend=3000, \n      arrow = arrow(ends = \"both\", angle = 90, length = unit(.2,\"cm\")),\n      color=\"darkblue\"\n      ) + \n    annotate(\n      \"text\", \n      x=as.POSIXct(\"2011-09-01\"),\n      y=5500, \n      label=str_wrap(\"openings begin steadily rising\", width=15),\n      color = \"darkblue\",\n      size = 2\n      ) +\n    annotate(\n      \"segment\", \n      x= as.POSIXct(\"2018-08-01\"), \n      xend=as.POSIXct(\"2018-11-01\"), \n      y=20000, \n      yend=14000, \n      arrow = arrow(), \n      color=\"darkblue\") +\n    annotate(\n      \"text\", \n      x=as.POSIXct(\"2018-08-01\"),\n      y=21000, \n      label=str_wrap(\"rate of openings increase\", width=30),\n      color = \"darkblue\",\n      size = 2\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nFrom the plot above we can see that electric charging stations began steadily increasing around 2011, a bit after the release of the Nissan Leaf and Chevy Volt---the first mass produced electric vehicles. Then around 2018, growth of electric charging stations increased, possibly due to Tesla's slow start to shipping orders for the Model 3, leading to a slower adoption by new electric vehicle owners.\n\n## Fuel Types\n\nWe can get a clearer picture of how many more electric fuel stations there are than any other kind with a direct comparison.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations |>\n    group_by(fuel_type) |> \n    summarize(n = n()) |> \n    mutate(fuel_type = fct_reorder(fuel_type, n)) |> \n    ggplot(aes(fuel_type, n)) + \n    geom_col(show.legend = FALSE, fill=\"darkblue\") + \n    coord_flip() +\n    labs(\n      x=\"\", \n      y=\"Total Stations\", \n      title=\"Total Number of Stations for Each Fuel Type\"\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/plot-fuel-types-1.png){width=672}\n:::\n:::\n\n\nIt's clear from the plot above that electric fuel stations vastly outnumber every other fuel station combined. Because electric stations make up the vast majority of stations, we will reduce our scope by filtering our data to only contain electric fueling stations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_elec <- stations |> \n    filter(fuel_type == \"ELEC\")\n```\n:::\n\n\nFocusing on electric fuel stations, we can look at which cities have the most stations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_elec |> \n    # count the stations in each city, state\n    count(state, city) |> \n    # order from most to least\n    arrange(desc(n)) |> \n    # get the top 20 cities with the most stations\n    head(20) |> \n    # reorder the factors based on the most stations\n    mutate(city = fct_reorder(city, n)) |> \n    ggplot(aes(city, n, fill=state)) +\n    geom_col() + \n    coord_flip() + \n    labs(\n      x=\"\", \n      y=\"Total Electric Stations\", \n      title=\"Total Electric Stations by City\", \n      fill=\"State\"\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/plot-elec-cities-1.png){width=672}\n:::\n:::\n\n\nThe city of Los Angeles has the most electric fuel stations and about twice as much as the San Diego which has the second highest number of stations. 9 out of the 20 cities with the highest number of electric fuel stations are in California, indicating that California may contain more stations than any other state.\n\nWe can confirm this by now plotting the states with the highest number of stations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_elec |> \n    # count the number of stations in each state\n    count(state) |>  \n    # reorder the factors based on number of stations\n    mutate(state = fct_reorder(state, n)) |> \n    ggplot(aes(state, n)) +\n    geom_col(show.legend = FALSE, fill=\"darkblue\") + \n    coord_flip() + \n    labs(\n      x=\"\", \n      y=\"Total Number of Stations\", \n      title=\"Total Number of Electric Stations by State\"\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/plot-elec-states-1.png){width=672}\n:::\n:::\n\n\nBased on the plot above, California clearly leads the country in number of electric fueling stations. How do they compare when taking into account the size of the state?\n\nBy dividing the total number of stations each state has by the area of the state we can get a \"station density\" for each state to better compare stations across each state. For example, if a very large state such as Texas has as many fueling stations as a smaller state like Massachusetts, then Massachusetts likely has better electric station coverage than Texas as the stations per area is important for fueling during travel.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculate station densities\nstation_den <- station_elec |> \n  # count the station stations for each state and year\n  count(state, open_year, pop_den, area, name=\"num_stations\") |> \n  # group by the state to prepare for a cumulative sum\n  group_by(state) |> \n  # arrange by state and year later sum in the correct order\n  arrange(state, open_year) |> \n  # calculate the cumulative sum of stations for eachs state\n  # and calcualte station densities over time\n  mutate(\n    tot_stations = cumsum(num_stations), \n    station_density = tot_stations / area\n    )  |> \n  # keep the following features\n  select(state, open_year, pop_den, station_density) |>\n  ungroup() |> \n  # make sure every state / year combination exists\n  complete(state, open_year) |>\n  # group by the state\n  group_by(state) |> \n  # fill in any missing state / year combinations with the \n  # densities from the previous year\n  fill(pop_den, station_density, .direction=\"down\") |> \n  ungroup() |> \n  # any NAs will be because there was no previous data, so\n  # these can be set to zero\n  mutate(pop_den = replace_na(pop_den, 0), station_density = replace_na(station_density, 0))\n```\n:::\n\n\nWe can plot the newly calculated station densities:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_den |> \n    filter(open_year == 2020) |> \n    mutate(state = fct_reorder(state, station_density)) |> \n    ggplot(aes(state, station_density)) +\n    geom_col(show.legend = FALSE, fill=\"darkblue\") + \n    coord_flip() +\n    labs(\n      x=\"\", \n      y=\"Electric Station Density (stations / sq. mi.)\", \n      title=\"Electric Station Density by State\"\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/plot-elec-states-density-1.png){width=672}\n:::\n:::\n\n\n# Model Building\n\n### Regressing Station Density on Population Density\n\nA sufficient number of fuel stations must be created to cover the area of land and the population of people that they are meant to serve. Given that fuel stations are being produced to meet the needs of their land area and population, we can expect to see a positive correlation between the population density of a given state and the station density in that state.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_den_2020 <- filter(station_den, open_year==2020)\n\nstation_den_2020 |> \n    ggplot(aes(pop_den, station_density)) +\n    geom_point() + \n    # put both axes on log scale to transform exponential data to linear\n    scale_x_log10() + \n    scale_y_log10() + \n    geom_smooth(method = \"lm\", se=FALSE) + \n    stat_cor() + \n    geom_text(aes(label=state), check_overlap = TRUE, vjust = 1, hjust = 1) + \n    labs(\n      y=\"Electric Station Density (stations / sq. mi.)\", \n      x = \"Population Density (population / sq. mi.)\" , \n      title=\"Do States with Higher Population Densities Have Higher Station Densities?\"\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nWe can build a linear model to make inferences about the relationship. We'll use a log transform for both the predictor and response variables as we did above in the plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# build a linear regression model regressing station density onto population density\nlm_mod <- linear_reg() |> \n  fit(log10(station_density) ~ log10(pop_den), data=station_den_2020)\n\n# get the 95% confidence intervals\ncoef <- tidy(lm_mod, conf.int = TRUE, conf.level=0.95) |> \n  filter(term != \"(Intercept)\")\n\n# print a table of the model summary\ncoef |> \n  select(estimate, conf.low, conf.high) |> \n  cbind(glance(lm_mod)) |> \n  select(estimate, r.squared, statistic, conf.low, conf.high) |> \n  kable()\n```\n\n::: {.cell-output-display}\n| estimate| r.squared| statistic|  conf.low| conf.high|\n|--------:|---------:|---------:|---------:|---------:|\n| 1.043191| 0.8716973|  312.5271| 0.9244118|  1.161971|\n:::\n:::\n\n\nThe linear regression model shows a strong correlation of 0.93 between the population density of a state and the station density of that state. With this correlation, we have an $R^2$ showing that our model explains about 87% of the variability in the data. We also obtained a p-value of 3.855847\\times 10^{-22}. This implies that under a null hypothesis that the linear model has a slope of 0, there is a near zero probability that we would find the calculated slope above from random samples of the data. This indicates that the relationship found between population density and station density is statistically significant.\n\nBecause we used a logarithmic transform for both the predictor and response variables, we **cannot** simply infer that for each 1 unit increase in the population density, we expect to see, on average, a 1.04 $\\pm$ 0.12 increase in station density. Instead, taking the logarithmic transforms into account, we can infer from this model that for every 1% increase in the population density of a state, we can expect, on average, a 1.04% $\\pm$ 0.12% increase in the station density for that state ([UVA Library StatLab](https://data.library.virginia.edu/interpreting-log-transformations-in-a-linear-model/)).\n\nWe can create an animated version of the plot above to see how the regression line has changed over time:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_den |> \n  #filter(state == \"Wyoming\") |> \n  ggplot(aes(pop_den, station_density)) + \n  geom_point(show.legend = FALSE) + \n  scale_x_log10() + \n  scale_y_log10() + \n  geom_smooth(method = \"lm\", se=FALSE) +\n  geom_text(aes(label=state), check_overlap = TRUE) + \n  transition_time(open_year) + \n  labs(\n    title=\"Population and Station Density Changes over Time\", \n    subtitle=\"Year: {round(frame_time)}\",\n    y=\"Electric Station Density (stations / sq. mi.)\", \n    x = \"Population Density (population / sq. mi.)\" ,\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.gif)\n:::\n:::\n\n\nThe slope of the regression line is fairly stable between 2010 and 2020 and seems to have remained about the same between 2013 and 2020. In addition to the consistency in slope, the correlation appears to be consistent during that time as well. As expected, population densities had negligible change, but there has been a steady rise in electric charging stations as we have seen in previous visualizations. Based on the steady correlations we're seeing in this animation, it appears that each state is increasing their electric station density at around the same exponential rate (data has been log transformed).\n\nIt could be interesting to see how this trend evolves over time as more data becomes available. We may see the intercept coefficient continue to increase with the electric station density, but the slope relationship between population density and station density remain the same, indicating that there is a stable (and possibly planned) relationship between population density and station density to meet the needs electric vehicle owners across all states.\n\n## Conclusion\n\nThis analysis focused on understanding the distribution electric fueling stations across the US between the years 2010-2020 and attempted to better understand the relationship between a state's population and the number of stations in the state. Electric vehicle charging station growth rate seems to coincide with the release of popular electric cars which drive larger adoption of electric vehicles and increase the demand for electric charging stations. We also showed a strong correlation between the population density of a state and the number of electric charging stations per square mile in that state. From this, we were able to infer that for every 1% increase in the population density of a state, we can expect, on average, a 1.04% $\\pm$ 0.12% increase in the station density for that state. Looking at an animation of this trend through time, the slope and strength of correlation appear to be consistent through much of 2010 - 2020.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}